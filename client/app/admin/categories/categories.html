<h1 class="page-title no-margin pad border-bottom">
  <i class="fa fa-tags"></i> Product Categories
</h1>

<div class="row margin-vertical-10">
  <div class="col-md-4 col-sm-4">
    <div class="card card-solid category-form">
      <form class="form" name="form" novalidate ng-submit="submitCategory(form)">
        <div class="card-header" id="category-form-header">
          <h2 class="card-title">{{isEdit ? 'Edit' : 'Add new'}} Category</h2>
        </div>
        <div class="card-body">
          <div class="alert alert-danger" role="alert" ng-show="!form.$valid && submitted">
            <i class="fa fa-warning"></i>
            <p class="help-block" ng-show="form.name.$error.mongoose || form.slug.$error.mongoose">
            {{ errors.other }}
            </p>
            <p class="help-block"
               ng-show="(form.name.$error.required) && (form.name.$dirty || submitted)">
              Name can not be empty.
            </p>
            <p class="help-block"
               ng-show="(form.slug.$error.required) && (form.slug.$dirty || submitted)">
              Slug can not be empty.
            </p>
            <p class="help-block"
               ng-show="(form.name.$error.maxlength) && (form.name.$dirty || submitted)">
              Name must be less than 50 characters.
            </p>
            <p class="help-block"
               ng-show="(form.slug.$error.maxlength) && (form.slug.$dirty || submitted)">
              Slug must be less than 50 characters.
            </p>
            <p class="help-block"
               ng-show="(form.info.$error.maxlength) && (form.info.$dirty || submitted)">
              Description must be less than 350 characters.
            </p>
            <p class="help-block"
               ng-show="imageMissing && submitted">
              Category Icon is required.
            </p>
          </div>
          <div class="form-group" ng-class="{ 'has-success': form.name.$valid && submitted, 'has-error': form.name.$invalid && submitted }">
            <label class="text-cursor-pointer control-label" for="name">Name*:</label>
            <input type="text" name="name" id="name" class="form-control" ng-model="category.name" required mongoose-error placeholder="Category Name" ng-maxlength="50"/>
          </div>
          <div class="form-group" ng-class="{ 'has-success': form.slug.$valid && submitted, 'has-error': form.slug.$invalid && submitted }">
            <label class="text-cursor-pointer control-label" for="slug">Slug*:</label>
            <input type="text" name="slug" id="slug" class="form-control" ng-model="category.slug" required mongoose-error placeholder="URL Slug" ng-maxlength="50"/>
            <span class="helper text-small">
              The “slug” is the URL-friendly version of the name. It is usually all lowercase and contains only letters, numbers, and hyphens.
            </span>
          </div>
          <div class="form-group" ng-class="{ 'has-success': form.info.$valid && submitted, 'has-error': form.info.$invalid && submitted }">
            <label class="text-cursor-pointer control-label" for="info">Description:</label>
            <textarea rows="5" cols="26" name="info" class="form-control" id="info" ng-model="category.info" placeholder="Category Description" ng-maxlength="350"></textarea>
          </div>
          <div class="form-group margin-bottom-1">
            <label class="text-cursor-pointer control-label" for="image">Category Image:</label>
            <div ng-show="!category.image || category.image === ''">
              <img src="../../../assets/images/no.png" width="64" height="64" class="thumb" />
              <span class="btn btn-default btn-sm" ng-click="openUploder()">Upload image</span>
            </div>
            <div ng-show="category.image && category.image !== ''">
              <span ng-switch="category.isIcon">
                <img ng-switch-when="false" class="thumb" src="{{getImageUrl(category.image)}}" width="64" height="64" />
                <i ng-switch-when="true" class="fa fa-3x fa-fw {{category.image}} thumb"></i>
                <span class="btn btn-default btn-sm" ng-click="openUploder()">Change</span>
                <span class="btn btn-danger btn-sm" ng-click="removeCategoryImage();">Remove</span>
              </span>
            </div>
          </div>
          <clearfix></clearfix>
        </div>
        <div class="card-footer">
          <button class="btn btn-success" type="submit">{{isEdit ? 'Edit' : 'Add new'}} category</button>
          <a href="#" class="btn btn-default" type="reset" role="button" ng-click="reset();" ng-show="isEdit">Cancel</a>
        </div>
      </form>
    </div>
  </div>
  <div class="col-md-8 col-sm-8">
    <div class="row">
      <div class="col-md-9 col-sm-9 margin-top-10">
        <div class="btn-group" role="group">
          <button type="button" tooltip="For Selected Categories" class="btn btn-sm btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
            Bulk Action
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu">
            <li><a href="#" class="text-red" ng-click="bulkDelete('Selected Categories')">Delete</a></li>
          </ul>
        </div>
      </div>
      <div class="col-md-3 col-sm-3 margin-top-10 text-right">
        <span class="text-muted text-italic">{{categories.length}} categories</span>
      </div>
    </div>
    <div class="card card-solid pad-10 margin-top-10">
      <div class="card-overlay" ng-show="categoriesLoading">
        <span class="card-overlay-icon text-black">
          <i class="fa fa-refresh fa-spin fa-2x"></i>
        </span>
      </div>
      <table datatable="ng" dt-options="dtOptions" dt-column-defs="dtColumnDefs" class="table table-hover table-compact bg-white border">
        <thead>
          <tr class="bg-teal">
            <th class="text-center">
              <input type="checkbox" id="check_all" ng-model="allCheck" ng-click="checkAllCatgory();"/>
            </th>
            <th>&nbsp;</th>
            <th>Name</th>
            <th>Slug</th>
            <th>Description</th>
            <th>Date</th>
            <th>Products</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="category in categories" class="product-admin-box">
            <td width="5%" class="text-center">
              <input type="checkbox" id="check_for_{{category._id}}" ng-model="category.isChecked" />
            </td>
            <td width="5%" class="text-center">
              <span ng-show="!category.image || category.image === ''">
                <img src="../../../assets/images/no.png" width="40" height="40" />
              </span>
              <span ng-switch="category.isIcon" ng-show="category.image && category.image !== ''">
                <img ng-switch-when="false" class="product-image" src="{{getImageUrl(category.image)}}" width="40" height="40" />
                <i ng-switch-when="true" class="fa fa-2x fa-fw {{category.image}}"></i>
              </span>
            </td>
            <td width="25%">
              <a href="/category/{{category._id}}">
                {{category.name}}
              </a>
              <div class="actions">
                <a href="#" class="text-small text-underline" ng-click="editCategory(category);">Edit</a>
                |
                <a href="#" class="text-small text-danger text-underline" ng-click="deleteCategory(category.name, category._id);">Delete</a>
                |
                <a href="#" class="text-small text-underline" ng-click="duplicateCategory(category);">Duplicate</a>
              </div>
            </td>
            <td width="15%">
              <span class="text-muted">{{category.slug ? category.slug : category._id}}</span>
            </td>
            <td width="30%">
              <span class="text-muted">{{category.info}}</span>
            </td>
            <td width="15%">
              <span class="text-muted">{{moment(category.createdAt).format(fullDateFormate)}}</span>
            </td>
            <td width="5%" class="text-right">
              <span class="text-muted">{{category.productCount}}</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
